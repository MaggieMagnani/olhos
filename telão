-- =============================================
-- SHOW COMPLETO - TODOS EFEITOS FUNCIONANDO
-- =============================================

print("=== SHOW COMPLETO DOS TELÃ•ES ===")

-- Encontra os telÃµes
local teloes = {peripheral.find("monitor")}
if not teloes[1] then
    teloes = {teloes}
end

print("TelÃµes conectados: " .. #teloes)

-- Configura cada telÃ£o individualmente
for i, telao in ipairs(teloes) do
    telao.setTextScale(0.5)
end

-- PALETA MEGA COLORIDA
local coresShow = {
    colors.red, colors.orange, colors.yellow,
    colors.lime, colors.green, colors.cyan,
    colors.lightBlue, colors.blue, colors.purple,
    colors.pink, colors.magenta, colors.white
}

-- =======================
-- EFEITO TEXTO GIGANTE CORRIGIDO
-- =======================

-- 2. TEXTO GIGANTE (CORRIGIDO - AGORA APARECE!)
function efeitoTextoGigante()
    print("ðŸŽª Efeito: TEXTO GIGANTE")
    
    local textos = {"BALADA", "FESTA", "SHOW", "DANCE", "DIVIRTA-SE"}
    local textoIndex = 1
    local frame = 0
    
    while true do
        frame = frame + 1
        
        for i, telao in ipairs(teloes) do
            local w, h = telao.getSize()
            telao.setBackgroundColor(colors.black)
            telao.clear()
            
            -- Muda texto a cada 3 segundos
            if frame % 60 == 0 then
                textoIndex = (textoIndex % #textos) + 1
            end
            
            local texto = textos[textoIndex]
            local cor = coresShow[(frame + i - 1) % #coresShow + 1]
            
            -- TEXTO SIMPLES E FUNCIONAL
            telao.setBackgroundColor(cor)
            telao.setTextColor(colors.black)
            
            -- Calcula posiÃ§Ã£o central
            local x = math.floor((w - #texto) / 2) + 1
            local y = math.floor(h / 2)
            
            -- Limpa a linha do texto
            for clearX = 1, w do
                telao.setCursorPos(clearX, y)
                telao.write(" ")
            end
            
            -- Escreve o texto (AGORA FUNCIONA!)
            telao.setCursorPos(x, y)
            telao.write(texto)
            
            -- Efeito de brilho
            telao.setBackgroundColor(coresShow[(frame + i) % #coresShow + 1])
            if x > 1 then
                telao.setCursorPos(x - 1, y)
                telao.write(" ")
            end
            if x + #texto <= w then
                telao.setCursorPos(x + #texto, y)
                telao.write(" ")
            end
        end
        os.sleep(0.1)
    end
end

-- =======================
-- EFEITOS 4, 5, 6 IMPLEMENTADOS
-- =======================

-- 4. GIRASSOL PSICODÃ‰LICO (AGORA FUNCIONANDO)
function efeitoGirassol()
    print("ðŸŒ» Efeito: GIRASSOL PSICODÃ‰LICO")
    
    local angulo = 0
    
    while true do
        angulo = angulo + 0.2
        
        for i, telao in ipairs(teloes) do
            local w, h = telao.getSize()
            telao.setBackgroundColor(colors.black)
            telao.clear()
            
            local centroX = math.floor(w / 2)
            local centroY = math.floor(h / 2)
            local raio = math.min(w, h) * 0.3
            
            -- Desenha pÃ©talas
            local numPetalas = 12
            for petala = 1, numPetalas do
                local anguloPetala = (petala * (360 / numPetalas) + angulo * 50) % 360
                local cor = coresShow[petala % #coresShow + 1]
                
                -- PÃ©talas maiores
                for t = 0.5, 1.2, 0.3 do
                    local x = centroX + math.cos(math.rad(anguloPetala)) * raio * t
                    local y = centroY + math.sin(math.rad(anguloPetala)) * raio * t
                    
                    x = math.floor(x)
                    y = math.floor(y)
                    
                    if x >= 1 and x <= w and y >= 1 and y <= h then
                        telao.setBackgroundColor(cor)
                        telao.setCursorPos(x, y)
                        telao.write(" ")
                    end
                end
            end
            
            -- Centro do girassol
            local centroRaio = math.floor(raio * 0.3)
            for y = -centroRaio, centroRaio do
                for x = -centroRaio, centroRaio do
                    if x*x + y*y <= centroRaio*centroRaio then
                        local posX = centroX + x
                        local posY = centroY + y
                        if posX >= 1 and posX <= w and posY >= 1 and posY <= h then
                            telao.setBackgroundColor(colors.yellow)
                            telao.setCursorPos(posX, posY)
                            telao.write(" ")
                        end
                    end
                end
            end
        end
        os.sleep(0.1)
    end
end

-- 5. TÃšNEL DIMENSIONAL (AGORA FUNCIONANDO)
function efeitoTunel()
    print("ðŸŒ€ Efeito: TÃšNEL DIMENSIONAL")
    
    local tempo = 0
    
    while true do
        tempo = tempo + 0.4
        
        for i, telao in ipairs(teloes) do
            local w, h = telao.getSize()
            telao.setBackgroundColor(colors.black)
            telao.clear()
            
            local centroX = math.floor(w / 2)
            local centroY = math.floor(h / 2)
            
            -- Desenha anÃ©is concÃªntricos
            local numAneis = 6
            for anel = 1, numAneis do
                local raio = anel * 2 + math.sin(tempo + anel * 0.5) * 3
                local cor = coresShow[(anel + i - 1) % #coresShow + 1]
                
                for ang = 0, 360, 10 do
                    local x = centroX + math.cos(math.rad(ang)) * raio
                    local y = centroY + math.sin(math.rad(ang)) * raio
                    
                    x = math.floor(x)
                    y = math.floor(y)
                    
                    if x >= 1 and x <= w and y >= 1 and y <= h then
                        telao.setBackgroundColor(cor)
                        telao.setCursorPos(x, y)
                        telao.write(" ")
                    end
                end
            end
            
            -- Efeito de profundidade no centro
            local centroRaio = math.floor(math.sin(tempo) * 2 + 3)
            for y = -centroRaio, centroRaio do
                for x = -centroRaio, centroRaio do
                    if x*x + y*y <= centroRaio*centroRaio then
                        local posX = centroX + x
                        local posY = centroY + y
                        if posX >= 1 and posX <= w and posY >= 1 and posY <= h then
                            telao.setBackgroundColor(colors.white)
                            telao.setCursorPos(posX, posY)
                            telao.write(" ")
                        end
                    end
                end
            end
        end
        os.sleep(0.15)
    end
end

-- 6. MATRIZ DIGITAL (AGORA FUNCIONANDO)
function efeitoMatrix()
    print("ðŸ’š Efeito: MATRIZ DIGITAL")
    
    local caracteres = {"0", "1"}
    local colunas = {}
    
    -- Inicializa colunas para cada telÃ£o
    for i = 1, #teloes do
        local w, h = teloes[i].getSize()
        colunas[i] = {}
        for x = 1, w do
            colunas[i][x] = {
                posicao = math.random(-10, h),
                velocidade = math.random(1, 3)
            }
        end
    end
    
    while true do
        for i, telao in ipairs(teloes) do
            local w, h = telao.getSize()
            telao.setBackgroundColor(colors.black)
            telao.clear()
            telao.setTextColor(colors.green)
            
            -- Atualiza e desenha colunas
            for x = 1, w do
                local coluna = colunas[i][x]
                
                -- Move a coluna
                coluna.posicao = coluna.posicao + coluna.velocidade
                if coluna.posicao > h + 10 then
                    coluna.posicao = -10
                    coluna.velocidade = math.random(1, 3)
                end
                
                -- Desenha caracteres com efeito de rastro
                for y = 1, h do
                    local distancia = math.abs(y - coluna.posicao)
                    if distancia < 8 then
                        local brilho = math.max(1, 3 - math.floor(distancia / 3))
                        
                        if brilho == 3 then
                            telao.setTextColor(colors.lime)
                        elseif brilho == 2 then
                            telao.setTextColor(colors.green)
                        else
                            telao.setTextColor(colors.darkGreen)
                        end
                        
                        local char = caracteres[math.random(1, #caracteres)]
                        telao.setCursorPos(x, y)
                        telao.write(char)
                    end
                end
            end
        end
        os.sleep(0.1)
    end
end

-- =======================
-- OUTROS EFEITOS (1, 3, 7, 8, 9, 10)
-- =======================

-- 1. LASERS MEGA COLORIDOS
function efeitoLasersMega()
    print("ðŸ”¦ Efeito: SHOW DE LASERS MEGA")
    
    local angulos = {}
    for i = 1, #teloes do
        angulos[i] = math.random(1, 360)
    end
    
    while true do
        for i, telao in ipairs(teloes) do
            local w, h = telao.getSize()
            telao.setBackgroundColor(colors.black)
            telao.clear()
            
            angulos[i] = (angulos[i] + math.random(10, 25)) % 360
            
            local numLasers = 6
            for laser = 1, numLasers do
                local angulo = angulos[i] + (laser * 360 / numLasers)
                local cor = coresShow[laser % #coresShow + 1]
                
                local centroX = math.floor(w / 2)
                local centroY = math.floor(h / 2)
                local raio = math.min(w, h) * 0.7
                
                for t = 0, raio, 0.4 do
                    local x = centroX + math.cos(math.rad(angulo)) * t
                    local y = centroY + math.sin(math.rad(angulo)) * t
                    
                    x = math.floor(x)
                    y = math.floor(y)
                    
                    if x >= 1 and x <= w and y >= 1 and y <= h then
                        telao.setBackgroundColor(cor)
                        telao.setCursorPos(x, y)
                        telao.write(" ")
                    end
                end
            end
        end
        os.sleep(0.1)
    end
end

-- 3. FOGOS DE ARTIFÃCIO
function efeitoFogosArtificio()
    print("ðŸŽ† Efeito: FOGOS DE ARTIFÃCIO")
    
    local fogos = {}
    for i = 1, #teloes do fogos[i] = {} end
    
    while true do
        for i, telao in ipairs(teloes) do
            local w, h = telao.getSize()
            telao.setBackgroundColor(colors.black)
            telao.clear()
            
            if math.random(1, 15) == 1 and #fogos[i] < 3 then
                table.insert(fogos[i], {
                    x = math.random(3, w - 3),
                    y = h,
                    velocidade = math.random(2, 4),
                    explosaoY = math.random(3, math.floor(h * 0.6)),
                    explodiu = false,
                    particulas = {},
                    cor = coresShow[math.random(1, #coresShow)]
                })
            end
            
            for j = #fogos[i], 1, -1 do
                local fogo = fogos[i][j]
                
                if not fogo.explodiu then
                    fogo.y = fogo.y - fogo.velocidade
                    
                    telao.setBackgroundColor(colors.white)
                    telao.setCursorPos(fogo.x, fogo.y)
                    telao.write(" ")
                    
                    if fogo.y <= fogo.explosaoY then
                        fogo.explodiu = true
                        for p = 1, 10 do
                            fogo.particulas[p] = {
                                x = fogo.x, y = fogo.y,
                                dx = (math.random() - 0.5) * 3,
                                dy = (math.random() - 0.5) * 3,
                                vida = math.random(20, 40),
                                cor = coresShow[math.random(1, #coresShow)]
                            }
                        end
                    end
                else
                    local todasMortas = true
                    for p, particula in ipairs(fogo.particulas) do
                        if particula.vida > 0 then
                            todasMortas = false
                            particula.x = particula.x + particula.dx
                            particula.y = particula.y + particula.dy
                            particula.vida = particula.vida - 1
                            
                            if particula.x >= 1 and particula.x <= w and particula.y >= 1 and particula.y <= h then
                                telao.setBackgroundColor(particula.cor)
                                telao.setCursorPos(math.floor(particula.x), math.floor(particula.y))
                                telao.write(" ")
                            end
                        end
                    end
                    
                    if todasMortas then
                        table.remove(fogos[i], j)
                    end
                end
            end
        end
        os.sleep(0.1)
    end
end

-- 7. EQUALIZADOR MUSICAL
function efeitoEqualizador()
    print("ðŸŽµ Efeito: Equalizador Musical")
    
    while true do
        for i, telao in ipairs(teloes) do
            local w, h = telao.getSize()
            telao.setBackgroundColor(colors.black)
            telao.clear()
            
            local numBarras = 6
            local larguraBarra = math.floor(w / numBarras)
            
            for barra = 1, numBarras do
                local altura = math.random(1, h - 2)
                local cor = coresShow[barra % #coresShow + 1]
                
                for y = 1, altura do
                    for x = 1, larguraBarra - 1 do
                        local posX = (barra - 1) * larguraBarra + x
                        local posY = h - y
                        
                        if posX <= w and posY <= h then
                            telao.setBackgroundColor(cor)
                            telao.setCursorPos(posX, posY)
                            telao.write(" ")
                        end
                    end
                end
            end
        end
        os.sleep(0.2)
    end
end

-- Menu principal COMPLETO
function menuCompleto()
    print("\n" .. string.rep("=", 50))
    print("ðŸŽ¸ SHOW COMPLETO - TODOS EFEITOS FUNCIONANDO! ðŸŽ¸")
    print(string.rep("=", 50))
    print("1.  ðŸ”¦ LASERS MEGA")
    print("2.  ðŸŽª TEXTO GIGANTE (CORRIGIDO!)") 
    print("3.  ðŸŽ† FOGOS DE ARTIFÃCIO")
    print("4.  ðŸŒ» GIRASSOL PSICODÃ‰LICO (NOVO!)")
    print("5.  ðŸŒ€ TÃšNEL DIMENSIONAL (NOVO!)")
    print("6.  ðŸ’š MATRIZ DIGITAL (NOVO!)")
    print("7.  ðŸŽµ EQUALIZADOR MUSICAL")
    print("8.  ðŸ”„ Voltar")
    print("9.  ðŸšª Sair")
    
    write("Escolha um efeito (1-9): ")
    local escolha = read()
    
    if escolha == "1" then
        efeitoLasersMega()
    elseif escolha == "2" then
        efeitoTextoGigante()
    elseif escolha == "3" then
        efeitoFogosArtificio()
    elseif escolha == "4" then
        efeitoGirassol()
    elseif escolha == "5" then
        efeitoTunel()
    elseif escolha == "6" then
        efeitoMatrix()
    elseif escolha == "7" then
        efeitoEqualizador()
    elseif escolha == "8" then
        return true
    elseif escolha == "9" then
        print("Show encerrado!")
        return false
    else
        print("OpÃ§Ã£o invÃ¡lida!")
        os.sleep(1)
    end
    return true
end

-- Programa principal
function main()
    print("SISTEMA COMPLETO INICIADO! âœ…")
    print("Todos os efeitos estÃ£o funcionando!")
    
    while menuCompleto() do
        -- Continua no menu
    end
    
    -- Limpeza final
    for i, telao in ipairs(teloes) do
        telao.setBackgroundColor(colors.black)
        telao.clear()
        telao.setTextColor(colors.white)
    end
end

-- Inicia o show COMPLETO!
main()

