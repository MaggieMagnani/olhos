-- =============================================
-- EFEITOS DAFT PUNK - LUZ BRANCA
-- =============================================

print("=== DAFT PUNK MODE ===")

-- Pega as 4 telas
local telas = {peripheral.find("monitor")}
if not telas[1] then telas = {telas} end
if #telas > 4 then
    local temp = {}
    for i = 1, 4 do temp[i] = telas[i] end
    telas = temp
end

print("Telas: " .. #telas)

-- Configura
for i, tela in ipairs(telas) do
    tela.setTextScale(0.5)
end

-- EFEITO 1: PULSO BRANCO SEQUENCIAL (Daft Punk style)
function pulsoSequencial()
    print("Pulso Sequencial - Daft Punk")
    
    local telaAtiva = 1
    
    while true do
        -- Apaga todas as telas
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        -- Acende apenas UMA tela de cada vez
        telas[telaAtiva].setBackgroundColor(colors.white)
        telas[telaAtiva].clear()
        
        -- Próxima tela
        telaAtiva = telaAtiva + 1
        if telaAtiva > #telas then telaAtiva = 1 end
        
        os.sleep(0.3)  -- Velocidade do pulso
    end
end

-- EFEITO 2: ONDA BRANCA
function ondaBranca()
    print("Onda Branca")
    
    local posicao = 0
    
    while true do
        posicao = posicao + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            tela.setBackgroundColor(colors.black)
            tela.clear()
            
            -- Calcula se esta tela deve estar acesa
            local deveAcender = (posicao % #telas) + 1 == i
            
            if deveAcender then
                tela.setBackgroundColor(colors.white)
                tela.clear()
            end
        end
        
        os.sleep(0.2)
    end
end

-- EFEITO 3: RESPIRAÇÃO BRANCA
function respiracao()
    print("Respiração Branca")
    
    local tempo = 0
    
    while true do
        tempo = tempo + 0.1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            
            -- Todas as telas respiram juntas
            tela.setBackgroundColor(colors.white)
            tela.clear()
        end
        
        -- Pausa (respiração)
        os.sleep(0.8)
        
        -- Apaga
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        os.sleep(0.4)
    end
end

-- EFEITO 4: BARRAS VERTICAIS BRANCAS
function barrasVerticais()
    print("Barras Verticais Brancas")
    
    local offset = 0
    
    while true do
        offset = offset + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            tela.setBackgroundColor(colors.black)
            tela.clear()
            
            -- Barras brancas verticais se movendo
            for barra = 1, 2 do  -- 2 barras por tela
                local x = (offset + barra * 4) % w + 1
                
                -- Desenha barra vertical branca
                for y = 1, h do
                    tela.setBackgroundColor(colors.white)
                    tela.setCursorPos(x, y)
                    tela.write(" ")
                end
            end
        end
        
        os.sleep(0.15)
    end
end

-- EFEITO 5: PONTOS BRANCOS SEQUENCIAIS
function pontosSequenciais()
    print("Pontos Sequenciais")
    
    local tempo = 0
    
    while true do
        tempo = tempo + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            tela.setBackgroundColor(colors.black)
            tela.clear()
            
            -- Um ponto branco que se move sequencialmente pelas telas
            if (tempo % #telas) + 1 == i then
                local x = math.floor(w / 2)
                local y = math.floor(h / 2)
                
                tela.setBackgroundColor(colors.white)
                tela.setCursorPos(x, y)
                tela.write(" ")
                
                -- Pequeno brilho ao redor
                tela.setCursorPos(x + 1, y)
                tela.write(" ")
                tela.setCursorPos(x - 1, y)
                tela.write(" ")
            end
        end
        
        os.sleep(0.25)
    end
end

-- EFEITO 6: GRADIENTE CINZA (Daft Punk elegante)
function gradientCinza()
    print("Gradiente Cinza")
    
    local tonsCinza = {
        colors.black,
        colors.gray, 
        colors.lightGray,
        colors.white,
        colors.lightGray,
        colors.gray
    }
    
    local posicao = 0
    
    while true do
        posicao = posicao + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            
            -- Gradiente de cinza horizontal
            for x = 1, w do
                local progresso = (x + posicao) % #tonsCinza
                local cor = tonsCinza[progresso + 1]
                
                for y = 1, h do
                    tela.setBackgroundColor(cor)
                    tela.setCursorPos(x, y)
                    tela.write(" ")
                end
            end
        end
        
        os.sleep(0.1)
    end
end

-- EFEITO 7: PISCADA ALEATÓRIA (não todas ligadas)
function piscadaAleatoria()
    print("Piscada Aleatória")
    
    while true do
        -- Apaga tudo
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        -- Acende algumas telas aleatoriamente (não todas)
        local telasParaAcender = math.random(1, #telas - 1)  -- Nunca todas
        
        for a = 1, telasParaAcender do
            local telaAleatoria = math.random(1, #telas)
            telas[telaAleatoria].setBackgroundColor(colors.white)
            telas[telaAleatoria].clear()
        end
        
        os.sleep(0.4)
        
        -- Apaga
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        os.sleep(0.3)
    end
end

-- Menu Daft Punk
function menu()
    print("\n" .. string.rep("=", 30))
    print("DAFT PUNK - LUZ BRANCA")
    print(string.rep("=", 30))
    print("1. Pulso Sequencial")
    print("2. Onda Branca")
    print("3. Respiração")
    print("4. Barras Verticais") 
    print("5. Pontos Sequenciais")
    print("6. Gradiente Cinza")
    print("7. Piscada Aleatória")
    print(string.rep("=", 30))
    
    write("Escolha (1-7): ")
    local e = read()
    
    if e == "1" then pulsoSequencial()
    elseif e == "2" then ondaBranca()
    elseif e == "3" then respiracao()
    elseif e == "4" then barrasVerticais()
    elseif e == "5" then pontosSequenciais()
    elseif e == "6" then gradientCinza()
    elseif e == "7" then piscadaAleatoria()
    else print("Inválido!"); os.sleep(1) end
end

-- Iniciar
while true do
    menu()
end
