-- =============================================
-- DAFT PUNK - TELAS ILIMITADAS
-- =============================================

print("=== DAFT PUNK - TELAS ILIMITADAS ===")

-- Pega TODAS as telas disponíveis
local telas = {peripheral.find("monitor")}
if not telas[1] then telas = {telas} end

print("Telas detectadas: " .. #telas)

-- Configura todas as telas
for i, tela in ipairs(telas) do
    tela.setTextScale(0.5)
end

-- EFEITO 1: PULSO SEQUENCIAL (funciona com qualquer número de telas)
function pulsoSequencial()
    print("Pulso Sequencial - " .. #telas .. " telas")
    
    local telaAtiva = 1
    
    while true do
        -- Apaga todas as telas
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        -- Acende apenas UMA tela de cada vez
        telas[telaAtiva].setBackgroundColor(colors.white)
        telas[telaAtiva].clear()
        
        -- Próxima tela (funciona com qualquer quantidade)
        telaAtiva = telaAtiva + 1
        if telaAtiva > #telas then telaAtiva = 1 end
        
        os.sleep(0.3)
    end
end

-- EFEITO 2: ONDA BRANCA (adaptável)
function ondaBranca()
    print("Onda Branca - " .. #telas .. " telas")
    
    local posicao = 0
    
    while true do
        posicao = posicao + 1
        
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
            
            -- Calcula se esta tela deve estar acesa
            local deveAcender = (posicao % #telas) + 1 == i
            
            if deveAcender then
                tela.setBackgroundColor(colors.white)
                tela.clear()
            end
        end
        
        os.sleep(0.2)
    end
end

-- EFEITO 3: RESPIRAÇÃO BRANCA (todas juntas)
function respiracao()
    print("Respiração Branca - " .. #telas .. " telas")
    
    while true do
        -- Acende todas
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.white)
            tela.clear()
        end
        
        os.sleep(0.8)  -- Tempo aceso
        
        -- Apaga todas
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        os.sleep(0.4)  -- Tempo apagado
    end
end

-- EFEITO 4: BARRAS VERTICAIS (independente por tela)
function barrasVerticais()
    print("Barras Verticais - " .. #telas .. " telas")
    
    local offset = 0
    
    while true do
        offset = offset + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            tela.setBackgroundColor(colors.black)
            tela.clear()
            
            -- Barras brancas verticais (cada tela tem seu próprio padrão)
            for barra = 1, 2 do
                local x = (offset + barra * 4 + i * 2) % w + 1
                
                for y = 1, h do
                    tela.setBackgroundColor(colors.white)
                    tela.setCursorPos(x, y)
                    tela.write(" ")
                end
            end
        end
        
        os.sleep(0.15)
    end
end

-- EFEITO 5: PONTOS SEQUENCIAIS (funciona com N telas)
function pontosSequenciais()
    print("Pontos Sequenciais - " .. #telas .. " telas")
    
    local tempo = 0
    
    while true do
        tempo = tempo + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            tela.setBackgroundColor(colors.black)
            tela.clear()
            
            -- Uma tela de cada vez mostra o ponto
            if (tempo % #telas) + 1 == i then
                local x = math.floor(w / 2)
                local y = math.floor(h / 2)
                
                tela.setBackgroundColor(colors.white)
                tela.setCursorPos(x, y)
                tela.write(" ")
                
                -- Pequeno brilho
                tela.setCursorPos(x + 1, y)
                tela.write(" ")
                tela.setCursorPos(x - 1, y)
                tela.write(" ")
            end
        end
        
        os.sleep(0.25)
    end
end

-- EFEITO 6: GRADIENTE CINZA (cada tela individual)
function gradientCinza()
    print("Gradiente Cinza - " .. #telas .. " telas")
    
    local tonsCinza = {
        colors.black,
        colors.gray, 
        colors.lightGray,
        colors.white,
        colors.lightGray,
        colors.gray
    }
    
    local posicao = 0
    
    while true do
        posicao = posicao + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            
            -- Cada tela tem seu próprio gradiente
            for x = 1, w do
                local progresso = (x + posicao + i * 3) % #tonsCinza
                local cor = tonsCinza[progresso + 1]
                
                for y = 1, h do
                    tela.setBackgroundColor(cor)
                    tela.setCursorPos(x, y)
                    tela.write(" ")
                end
            end
        end
        
        os.sleep(0.1)
    end
end

-- EFEITO 7: PISCADA ALEATÓRIA (N telas - nunca todas)
function piscadaAleatoria()
    print("Piscada Aleatória - " .. #telas .. " telas")
    
    while true do
        -- Apaga tudo
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        -- Acende algumas telas aleatoriamente (NUNCA todas)
        local maxTelas = math.max(1, #telas - 1)  -- No mínimo 1, no máximo total-1
        local telasParaAcender = math.random(1, maxTelas)
        
        for a = 1, telasParaAcender do
            local telaAleatoria = math.random(1, #telas)
            telas[telaAleatoria].setBackgroundColor(colors.white)
            telas[telaAleatoria].clear()
        end
        
        os.sleep(0.4)
        
        -- Apaga
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        os.sleep(0.3)
    end
end

-- EFEITO 8: GRUPOS SEQUENCIAIS (para muitas telas)
function gruposSequenciais()
    print("Grupos Sequenciais - " .. #telas .. " telas")
    
    local grupoAtual = 1
    local telasPorGrupo = math.max(1, math.floor(#telas / 3))  -- Divide em ~3 grupos
    
    while true do
        -- Apaga tudo
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        
        -- Acende um grupo de telas
        local inicio = (grupoAtual - 1) * telasPorGrupo + 1
        local fim = math.min(grupoAtual * telasPorGrupo, #telas)
        
        for i = inicio, fim do
            if telas[i] then
                telas[i].setBackgroundColor(colors.white)
                telas[i].clear()
            end
        end
        
        -- Próximo grupo
        grupoAtual = grupoAtual + 1
        if grupoAtual > math.ceil(#telas / telasPorGrupo) then
            grupoAtual = 1
        end
        
        os.sleep(0.5)
    end
end

-- Menu para N telas
function menu()
    print("\n" .. string.rep("=", 35))
    print("DAFT PUNK - " .. #telas .. " TELAS")
    print(string.rep("=", 35))
    print("1. Pulso Sequencial")
    print("2. Onda Branca")
    print("3. Respiração")
    print("4. Barras Verticais") 
    print("5. Pontos Sequenciais")
    print("6. Gradiente Cinza")
    print("7. Piscada Aleatória")
    print("8. Grupos Sequenciais")
    print(string.rep("=", 35))
    
    write("Escolha (1-8): ")
    local e = read()
    
    if e == "1" then pulsoSequencial()
    elseif e == "2" then ondaBranca()
    elseif e == "3" then respiracao()
    elseif e == "4" then barrasVerticais()
    elseif e == "5" then pontosSequenciais()
    elseif e == "6" then gradientCinza()
    elseif e == "7" then piscadaAleatoria()
    elseif e == "8" then gruposSequenciais()
    else print("Inválido!"); os.sleep(1) end
end

-- Iniciar
while true do
    menu()
end
