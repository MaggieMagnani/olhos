-- EFEITO 9 NOVO: ONDA DE CORES ENTRE TELAS
function ondaDeCores()
    print("Onda de Cores - Cores fluindo suavemente entre telas!")
    print("Pressione CTRL+T para parar")
    
    local posicaoOnda = 0
    executandoEfeito = true
    
    while executandoEfeito do
        posicaoOnda = posicaoOnda + 1
        
        for i, tela in ipairs(telas) do
            local w, h = tela.getSize()
            
            -- CORES VIBRANTES (arco-íris fixo)
            local coresArcoiris = {
                colors.red, colors.orange, colors.yellow, 
                colors.green, colors.cyan, colors.blue, 
                colors.purple, colors.pink, colors.magenta
            }
            
            -- CALCULAR FASE DA ONDA PARA ESTA TELA
            local fase = (i + posicaoOnda) % #coresArcoiris
            local cor = coresArcoiris[fase + 1]
            
            -- PINTAR TELA INTEIRA COM A COR
            tela.setBackgroundColor(cor)
            tela.clear()
            
            -- EFEITO DE BRILHO/GRADIENTE
            for x = 1, w do
                local intensidade = (math.sin((x + posicaoOnda) * 0.2) + 1) / 2
                if intensidade > 0.8 then
                    -- Criar faixas mais claras/escuras
                    for y = 1, h do
                        if math.random(1, 3) == 1 then
                            tela.setBackgroundColor(colors.white)
                            tela.setCursorPos(x, y)
                            tela.write(" ")
                        end
                    end
                end
            end
        end
        
        os.sleep(aplicarVelocidade(0.25))
    end
    
    -- Limpar ao sair
    for i, tela in ipairs(telas) do
        tela.setBackgroundColor(colors.black)
        tela.clear()
    end
end

-- EFEITO 10 NOVO: PULSO CORACÃO
function pulsoCoracao()
    print("Pulso Coração - Batidas sincronizadas com cores!")
    print("Pressione CTRL+T para parar")
    
    local batida = 0
    local pulsando = false
    executandoEfeito = true
    
    -- CORES FORTES PARA PULSO
    local coresPulso = {
        colors.red, colors.pink, colors.magenta, 
        colors.orange, colors.yellow, colors.white
    }
    
    while executandoEfeito do
        batida = batida + 1
        
        if pulsando then
            -- FASE 1: PULSO FORTE (todas as telas acesas)
            for i, tela in ipairs(telas) do
                local corIndex = (batida % #coresPulso) + 1
                tela.setBackgroundColor(coresPulso[corIndex])
                tela.clear()
            end
            os.sleep(aplicarVelocidade(0.15))
            
            -- FASE 2: PULSO SUAVE (metade da intensidade)
            for i, tela in ipairs(telas) do
                if i % 2 == 0 then  -- Telas pares ficam mais escuras
                    tela.setBackgroundColor(colors.black)
                    tela.clear()
                end
            end
            os.sleep(aplicarVelocidade(0.1))
            
            pulsando = false
        else
            -- FASE 3: REPOUSO (apagado ou cores suaves)
            for i, tela in ipairs(telas) do
                if math.random(1, 3) == 1 then
                    -- Algumas telas ficam com cor fraca
                    local corFraca = colors.gray
                    tela.setBackgroundColor(corFraca)
                    tela.clear()
                else
                    tela.setBackgroundColor(colors.black)
                    tela.clear()
                end
            end
            os.sleep(aplicarVelocidade(0.4))
            
            pulsando = true
        end
        
        -- EFEITO ESPECIAL A CADA 5 BATIDAS
        if batida % 5 == 0 then
            -- PULSO RÁPIDO TRIPLO
            for pulsorapido = 1, 3 do
                for i, tela in ipairs(telas) do
                    tela.setBackgroundColor(colors.white)
                    tela.clear()
                end
                os.sleep(aplicarVelocidade(0.05))
                
                for i, tela in ipairs(telas) do
                    tela.setBackgroundColor(colors.black)
                    tela.clear()
                end
                os.sleep(aplicarVelocidade(0.05))
            end
        end
    end
    
    -- Limpar ao sair
    for i, tela in ipairs(telas) do
        tela.setBackgroundColor(colors.black)
        tela.clear()
    end
end

-- EFEITO 10 ALTERNATIVO: ESTROBE INTELIGENTE
function strobeInteligente()
    print("Strobe Inteligente - Padrões variados de strobe!")
    print("Pressione CTRL+T para parar")
    
    local ciclo = 0
    executandoEfeito = true
    
    local modosStrobe = {
        {"Todas juntas", function() 
            for i, tela in ipairs(telas) do
                tela.setBackgroundColor(colors.white)
                tela.clear()
            end
        end},
        
        {"Alternado", function() 
            for i, tela in ipairs(telas) do
                if i % 2 == ciclo % 2 then
                    tela.setBackgroundColor(colors.white)
                    tela.clear()
                else
                    tela.setBackgroundColor(colors.black)
                    tela.clear()
                end
            end
        end},
        
        {"Sequencial", function() 
            for i, tela in ipairs(telas) do
                tela.setBackgroundColor(colors.black)
                tela.clear()
            end
            local telaAtiva = (ciclo % #telas) + 1
            telas[telaAtiva].setBackgroundColor(colors.white)
            telas[telaAtiva].clear()
        end},
        
        {"Cores", function() 
            local cores = {colors.red, colors.blue, colors.green, colors.yellow, colors.purple}
            for i, tela in ipairs(telas) do
                local cor = cores[(i + ciclo) % #cores + 1]
                tela.setBackgroundColor(cor)
                tela.clear()
            end
        end}
    }
    
    while executandoEfeito do
        ciclo = ciclo + 1
        
        local modoIndex = (math.floor(ciclo / 10) % #modosStrobe) + 1
        local nomeModo, funcaoModo = modosStrobe[modoIndex][1], modosStrobe[modoIndex][2]
        
        -- APLICAR MODO ATUAL
        funcaoModo()
        os.sleep(aplicarVelocidade(0.1))
        
        -- APAGAR TUDO
        for i, tela in ipairs(telas) do
            tela.setBackgroundColor(colors.black)
            tela.clear()
        end
        os.sleep(aplicarVelocidade(0.1))
        
        -- MODO ESPECIAL A CADA 20 CICLOS
        if ciclo % 20 == 0 then
            -- STROBE ULTRA-RÁPIDO
            for i = 1, 8 do
                for j, tela in ipairs(telas) do
                    tela.setBackgroundColor(colors.white)
                    tela.clear()
                end
                os.sleep(aplicarVelocidade(0.02))
                
                for j, tela in ipairs(telas) do
                    tela.setBackgroundColor(colors.black)
                    tela.clear()
                end
                os.sleep(aplicarVelocidade(0.02))
            end
        end
    end
    
    -- Limpar ao sair
    for i, tela in ipairs(telas) do
        tela.setBackgroundColor(colors.black)
        tela.clear()
    end
end
