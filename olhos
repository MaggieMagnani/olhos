-- ...existing code...
-- =============================================
-- OLHO PSICODÉLICO PARA BALADA NO MINECRAFT (versão: olho redondo, sem piscada)
-- ComputerCraft - Programa Completo
-- =============================================

-- Encontra e configura o monitor
local monitor = peripheral.find("monitor")
if not monitor then
    print("Nenhum monitor encontrado!")
    return
end

monitor.setTextScale(0.5)
local width, height = monitor.getSize()

-- Cores psicodélicas disponíveis
local psychedelicColors = {
    colors.red, colors.orange, colors.yellow,
    colors.green, colors.lime, colors.blue,
    colors.purple, colors.pink, colors.magenta,
    colors.cyan, colors.white
}

-- Função para cor aleatória
local function getRandomColor()
    return psychedelicColors[math.random(1, #psychedelicColors)]
end

-- Função para desenhar olho redondo (sclera circular)
local function drawRoundEye(cx, cy, radius)
    monitor.setBackgroundColor(colors.white)
    for y = -radius, radius do
        for x = -radius, radius do
            if x*x + y*y <= radius*radius then
                local screenX = cx + x
                local screenY = cy + y
                if screenX >= 1 and screenX <= width and screenY >= 1 and screenY <= height then
                    monitor.setCursorPos(screenX, screenY)
                    monitor.write(" ")
                end
            end
        end
    end
end

-- Função para desenhar íris e pupila (escala relativa ao tamanho da tela)
local function drawIris(cx, cy, color, pupilSize, offsetX, offsetY, scleraRadius)
    local irisRadius = math.max(1, math.floor(scleraRadius * 0.45))
    local pupilRadius = math.max(1, math.floor(irisRadius * pupilSize))

    local irisX = cx + offsetX
    local irisY = cy + offsetY

    -- Desenha íris
    monitor.setBackgroundColor(color)
    for y = -irisRadius, irisRadius do
        for x = -irisRadius, irisRadius do
            if x*x + y*y <= irisRadius*irisRadius then
                local screenX = irisX + x
                local screenY = irisY + y
                if screenX >= 1 and screenX <= width and screenY >= 1 and screenY <= height then
                    monitor.setCursorPos(screenX, screenY)
                    monitor.write(" ")
                end
            end
        end
    end

    -- Desenha pupila
    monitor.setBackgroundColor(colors.black)
    for y = -pupilRadius, pupilRadius do
        for x = -pupilRadius, pupilRadius do
            if x*x + y*y <= pupilRadius*pupilRadius then
                local screenX = irisX + x
                local screenY = irisY + y
                if screenX >= 1 and screenX <= width and screenY >= 1 and screenY <= height then
                    monitor.setCursorPos(screenX, screenY)
                    monitor.write(" ")
                end
            end
        end
    end
end

-- Movimento suave do olho
local function getEyeMovement()
    local time = os.clock()
    local moveX = math.floor(math.sin(time * 1.7) * width * 0.08)
    local moveY = math.floor(math.cos(time * 1.3) * height * 0.08)
    return moveX, moveY
end

-- Função principal para desenhar o olho completo (sem piscada)
local function drawEye(irisColor, pupilSize, offsetX, offsetY)
    -- fundo do frame
    monitor.setBackgroundColor(colors.black)
    monitor.clear()

    local centerX = math.floor(width / 2)
    local centerY = math.floor(height / 2)
    local scleraRadius = math.max(2, math.floor(math.min(width, height) * 0.45))

    drawRoundEye(centerX, centerY, scleraRadius)
    drawIris(centerX, centerY, irisColor, pupilSize, offsetX, offsetY, scleraRadius)
end

-- Loop principal do programa (SEM PISCADA)
local function main()
    local colorChangeTimer = 0
    local currentColor = colors.blue

    print("Iniciando Olho Psicodélico (redondo, sem piscada)...")
    print("Tamanho do monitor: " .. width .. "x" .. height)

    while true do
        local currentTime = os.clock()

        -- Muda cor a cada 1.5 segundos
        if currentTime - colorChangeTimer > 1.5 then
            currentColor = getRandomColor()
            colorChangeTimer = currentTime
        end

        -- Movimento do olho
        local moveX, moveY = getEyeMovement()

        -- Desenha o olho (sempre aberto)
        drawEye(currentColor, 0.4, moveX, moveY)

        os.sleep(0.05)
    end
end

-- Inicialização
math.randomseed(os.time() or os.clock())
math.random(); math.random()
main()
-- ...existing code...
