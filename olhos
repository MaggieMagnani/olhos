-- =============================================
-- TESTE OLHO GIGANTE - 3 TELAS
-- =============================================

print("=== INICIANDO OLHO GIGANTE ===")

-- Encontra todos os monitores
local monitores = {peripheral.find("monitor")}
if not monitores[1] then
    monitores = {monitores}
end

print("Monitores conectados: " .. #monitores)

-- Configura todos os monitores
for i, mon in ipairs(monitores) do
    mon.setTextScale(0.5)
end

-- Pega o tamanho de cada monitor e calcula o total
local larguras = {}
local alturaTotal = 0
local larguraTotal = 0

for i, mon in ipairs(monitores) do
    local w, h = mon.getSize()
    larguras[i] = w
    larguraTotal = larguraTotal + w
    if h > alturaTotal then
        alturaTotal = h
    end
    print("Monitor " .. i .. ": " .. w .. "x" .. h)
end

print("Tela gigante: " .. larguraTotal .. "x" .. alturaTotal)

-- Função para desenhar em posição específica da tela gigante
function desenharNaTelaGigante(x, y, cor)
    local xAtual = 0
    
    for i, mon in ipairs(monitores) do
        local w = larguras[i]
        local h = alturaTotal
        
        -- Verifica se este ponto está neste monitor
        if x >= xAtual and x < xAtual + w and y >= 1 and y <= h then
            local xLocal = x - xAtual + 1
            local yLocal = y
            
            mon.setBackgroundColor(cor)
            mon.setCursorPos(xLocal, yLocal)
            mon.write(" ")
            return true
        end
        
        xAtual = xAtual + w
    end
    return false
end

-- Função para desenhar círculo na tela gigante
function desenharCirculo(centroX, centroY, raio, cor)
    for y = -raio, raio do
        for x = -raio, raio do
            if x*x + y*y <= raio*raio then
                desenharNaTelaGigante(centroX + x, centroY + y, cor)
            end
        end
    end
end

-- TESTE 1: Linha horizontal através das 3 telas
print("Desenhando linha de teste...")
for x = 1, larguraTotal do
    desenharNaTelaGigante(x, math.floor(alturaTotal/2), colors.red)
end
os.sleep(2)

-- TESTE 2: Círculo gigante
print("Desenhando círculo gigante...")
-- Limpa tudo
for i, mon in ipairs(monitores) do
    mon.setBackgroundColor(colors.black)
    mon.clear()
end

local centroX = math.floor(larguraTotal / 2)
local centroY = math.floor(alturaTotal / 2)
local raio = math.floor(math.min(larguraTotal, alturaTotal) * 0.4)

desenharCirculo(centroX, centroY, raio, colors.blue)
desenharCirculo(centroX, centroY, math.floor(raio * 0.7), colors.white)
desenharCirculo(centroX, centroY, math.floor(raio * 0.4), colors.red)

print("Teste concluído! Olhe as 3 telas!")
print("O círculo deve estar no CENTRO de todas as telas combinadas")

-- Inicialização
math.randomseed(os.clock())
main()
