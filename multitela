-- =============================================
-- SHOW DE LUZES - BALADA PSICODÉLICA
-- =============================================

print("=== SHOW DE LUZES INICIADO ===")

-- Encontra todos os monitores
local monitores = {peripheral.find("monitor")}
if not monitores[1] then
    monitores = {monitores}
end

print("Telas conectadas: " .. #monitores)

-- Configura todos os monitores
for i, mon in ipairs(monitores) do
    mon.setTextScale(0.5)
end

-- Paleta de cores psicodélicas
local cores = {
    colors.red,      -- 1
    colors.orange,   -- 2  
    colors.yellow,   -- 3
    colors.lime,     -- 4
    colors.green,    -- 5
    colors.cyan,     -- 6
    colors.blue,     -- 7
    colors.purple,   -- 8
    colors.pink,     -- 9
    colors.magenta,  -- 10
    colors.white,    -- 11
    colors.lightBlue -- 12
}

-- Função para preencher tela com cor (SEM TEXTO)
function preencherTela(numeroTela, cor)
    local mon = monitores[numeroTela]
    if mon then
        mon.setBackgroundColor(cor)
        mon.clear()  -- Apenas preenche com a cor, sem texto
    end
end

-- Função para resetar todas as telas
function resetarTelas()
    for i, mon in ipairs(monitores) do
        mon.setBackgroundColor(colors.black)
        mon.clear()
    end
end

-- =======================
-- NOVOS EFEITOS:
-- =======================

-- 1. ONDA SEQUENCIAL (sem texto)
function ondaSequencial()
    print("Efeito: Onda Sequencial")
    
    local sequencia = 1
    
    while true do
        for i = 1, #monitores do
            local cor = cores[(sequencia + i - 2) % #cores + 1]
            preencherTela(i, cor)
            os.sleep(0.2)  -- Velocidade da onda
        end
        os.sleep(0.3)
        resetarTelas()
        os.sleep(0.1)
        
        sequencia = sequencia + 1
    end
end

-- 2. CAOS COLORIDO (sem texto)
function caosColorido()
    print("Efeito: Caos Colorido")
    
    while true do
        local telaAleatoria = math.random(1, #monitores)
        local corAleatoria = cores[math.random(1, #cores)]
        
        preencherTela(telaAleatoria, corAleatoria)
        os.sleep(math.random(5, 20) / 100)  -- Mais rápido
        
        resetarTelas()
        os.sleep(0.05)
    end
end

-- 3. PULSAR SINCRONIZADO (sem texto)
function pulsarSincronizado()
    print("Efeito: Pulsar Sincronizado")
    
    local pulsos = 0
    
    while true do
        pulsos = pulsos + 1
        local corBase = cores[(pulsos - 1) % #cores + 1]
        
        -- Todas piscam juntas
        for i = 1, #monitores do
            preencherTela(i, corBase)
        end
        
        os.sleep(0.3)  -- Tempo ligado
        resetarTelas() -- Reseta
        os.sleep(0.2)  -- Tempo desligado
    end
end

-- 4. GRADIENTE HORIZONTAL
function gradienteHorizontal()
    print("Efeito: Gradiente Horizontal")
    
    while true do
        for inicioCor = 1, #cores do
            for i = 1, #monitores do
                local corIndex = (inicioCor + i - 2) % #cores + 1
                preencherTela(i, cores[corIndex])
            end
            os.sleep(0.4)
        end
    end
end

-- 5. XENON (flash rápido)
function efeitoXenon()
    print("Efeito: Xenon")
    
    while true do
        -- Flash branco rápido em todas as telas
        for i = 1, #monitores do
            preencherTela(i, colors.white)
        end
        os.sleep(0.1)
        
        resetarTelas()
        os.sleep(0.1)
        
        -- Flash colorido
        local corFlash = cores[math.random(1, #cores)]
        for i = 1, #monitores do
            preencherTela(i, corFlash)
        end
        os.sleep(0.15)
        
        resetarTelas()
        os.sleep(0.3)
    end
end

-- 6. RESPIRAR (fade simulado)
function efeitoRespirar()
    print("Efeito: Respirar")
    
    local fase = 1
    
    while true do
        local corBase = cores[(fase - 1) % #cores + 1]
        
        -- "Respira" por 3 ciclos com a mesma cor
        for ciclo = 1, 3 do
            -- Aumenta brilho (cores mais claras)
            for i = 1, #monitores do
                preencherTela(i, corBase)
            end
            os.sleep(0.4)
            
            -- Diminui brilho (volta ao preto)
            resetarTelas()
            os.sleep(0.3)
        end
        
        fase = fase + 1
    end
end

-- 7. ARCO-ÍRIS RODANDO
function arcoirisRodando()
    print("Efeito: Arco-Íris Rodando")
    
    local posicao = 1
    
    while true do
        for i = 1, #monitores do
            local corIndex = (posicao + i - 2) % #cores + 1
            preencherTela(i, cores[corIndex])
        end
        
        os.sleep(0.3)
        posicao = posicao + 1
        
        if posicao > #cores then
            posicao = 1
        end
    end
end

-- 8. ESTROBOSCOPIO ALEATÓRIO
function estroboscopio()
    print("Efeito: Estroboscópio")
    
    while true do
        -- Ativa telas aleatórias
        for i = 1, #monitores do
            if math.random(1, 2) == 1 then  -- 50% de chance
                preencherTela(i, colors.white)
            end
        end
        
        os.sleep(0.08)  -- Muito rápido
        resetarTelas()
        os.sleep(0.12)
    end
end

-- Menu principal melhorado
function menu()
    resetarTelas()
    
    print("\n=== SHOW DE LUZES - BALADA ===")
    print("1.  Onda Sequencial")
    print("2.  Caos Colorido") 
    print("3.  Pulsar Sincronizado")
    print("4.  Gradiente Horizontal")
    print("5.  Xenon (Flash)")
    print("6.  Respirar")
    print("7.  Arco-Íris Rodando")
    print("8.  Estroboscópio")
    print("9.  Sair")
    
    write("Escolha um efeito (1-9): ")
    local escolha = read()
    
    if escolha == "1" then
        ondaSequencial()
    elseif escolha == "2" then
        caosColorido()
    elseif escolha == "3" then
        pulsarSincronizado()
    elseif escolha == "4" then
        gradienteHorizontal()
    elseif escolha == "5" then
        efeitoXenon()
    elseif escolha == "6" then
        efeitoRespirar()
    elseif escolha == "7" then
        arcoirisRodando()
    elseif escolha == "8" then
        estroboscopio()
    elseif escolha == "9" then
        print("Show encerrado!")
        resetarTelas()
        return
    else
        print("Opção inválida!")
        os.sleep(1)
        menu()
    end
end

-- Inicialização
print("Show de Luzes pronto com " .. #monitores .. " telas!")
print("Pressione Ctrl+T para parar qualquer efeito")
os.sleep(2)

-- Inicia o menu
menu()
